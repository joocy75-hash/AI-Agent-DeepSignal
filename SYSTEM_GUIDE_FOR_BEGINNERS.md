# 🤖 Auto-Dashboard 트레이딩 봇 시스템 완전 가이드

> **작성일**: 2025-12-09  
> **대상**: 초보자도 이해할 수 있는 시스템 설명서

---

## 📚 목차

1. [전체 시스템 개요](#-전체-시스템-개요)
2. [핵심 컴포넌트 설명](#-핵심-컴포넌트-설명)
3. [주문이 실행되는 과정](#-주문이-실행되는-과정)
4. [AI의 역할](#-ai의-역할)
5. [폴더 구조 설명](#-폴더-구조-설명)
6. [실제 코드 흐름](#-실제-코드-흐름)

---

## 🌐 전체 시스템 개요

### 시스템을 한 마디로 설명하면?

> **"사용자가 선택한 전략에 따라 자동으로 비트코인/이더리움을 사고파는 로봇"**

### 전체 구성도 (집으로 비유)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         🏠 Auto-Dashboard 시스템                          │
│                                                                         │
│   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐      │
│   │    🖥️ 프론트엔드   │   │    🔧 백엔드     │   │    🗄️ 데이터베이스 │      │
│   │   (사용자 화면)   │◀─▶│   (두뇌/엔진)    │◀─▶│   (기억 저장소)   │      │
│   │                 │   │                 │   │                 │      │
│   │ • 로그인 화면    │   │ • 주문 실행     │   │ • 사용자 정보    │      │
│   │ • 차트 보기     │   │ • 전략 판단     │   │ • API 키       │      │
│   │ • 봇 시작/중지  │   │ • 잔고 조회     │   │ • 거래 기록     │      │
│   │ • 포지션 확인   │   │ • 알림 전송     │   │ • 전략 설정     │      │
│   └─────────────────┘   └─────────────────┘   └─────────────────┘      │
│           │                     │                                       │
│           │                     ▼                                       │
│           │           ┌─────────────────┐                               │
│           │           │   📡 Bitget     │  ← 실제 거래소                 │
│           │           │   거래소 API    │                               │
│           │           └─────────────────┘                               │
│           │                     │                                       │
│           │                     ▼                                       │
│           │           ┌─────────────────┐                               │
│           └──────────▶│   📱 Telegram   │  ← 알림 전송                   │
│                       │   봇 알림       │                               │
│                       └─────────────────┘                               │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🧩 핵심 컴포넌트 설명

### 1. 프론트엔드 (Frontend) - 사용자 화면

> **비유**: 자동차의 **운전대, 계기판, 버튼**

```
사용자가 보는 화면들:

┌─────────────────────────────────────────┐
│  🔐 로그인 페이지                        │
│  • 이메일/비밀번호로 로그인               │
│  • 구글/카카오 소셜 로그인               │
└─────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────┐
│  📊 트레이딩 대시보드                    │
│  • 실시간 차트 (비트코인, 이더리움)       │
│  • 현재 포지션 상태                      │
│  • 계정 잔고                            │
│  • 봇 시작/중지 버튼                     │
└─────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────┐
│  ⚙️ 설정 페이지                          │
│  • Bitget API 키 등록                   │
│  • 텔레그램 알림 설정                    │
│  • 전략 선택                            │
└─────────────────────────────────────────┘
```

**파일 위치**: `frontend/src/pages/`

---

### 2. 백엔드 (Backend) - 두뇌/엔진

> **비유**: 자동차의 **엔진, 컴퓨터**

```
백엔드가 하는 일들:

┌─────────────────────────────────────────┐
│  🔄 실시간 데이터 수신                   │
│  • Bitget에서 가격 데이터 받기           │
│  • 1분마다 캔들(봉) 데이터 업데이트       │
└─────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────┐
│  🧠 전략 분석                            │
│  • "지금 사야 할까? 팔아야 할까?"         │
│  • RSI, 볼린저밴드 등 지표 계산          │
│  • 진입/청산 조건 판단                   │
└─────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────┐
│  💰 주문 실행                            │
│  • Bitget에 매수/매도 주문 전송          │
│  • 레버리지 설정                         │
│  • 포지션 관리                          │
└─────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────┐
│  📱 알림 전송                            │
│  • 텔레그램으로 거래 알림 전송           │
│  • "BTCUSDT LONG 진입! 가격: $90,000"   │
└─────────────────────────────────────────┘
```

**파일 위치**: `backend/src/services/`

---

### 3. 데이터베이스 (Database) - 기억 저장소

> **비유**: **서류 보관함**

```
저장되는 정보들:

┌─────────────────────────────────────────┐
│  👤 users (사용자 테이블)                │
│  • id: 1                                │
│  • email: admin@admin.com               │
│  • password: (암호화됨)                  │
│  • role: admin                          │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│  🔑 api_keys (API 키 테이블)             │
│  • user_id: 1                           │
│  • api_key: bg_xxx... (암호화됨)         │
│  • api_secret: xxx... (암호화됨)         │
│  • passphrase: xxx... (암호화됨)         │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│  📈 strategies (전략 테이블)             │
│  • id: 1                                │
│  • name: RSI 역추세 전략                 │
│  • code: (전략 코드)                     │
│  • params: {"leverage": 10, ...}        │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│  📊 trades (거래 기록 테이블)            │
│  • symbol: BTCUSDT                      │
│  • side: buy                            │
│  • price: 90000                         │
│  • size: 0.01                           │
│  • timestamp: 2025-12-09 12:00:00       │
└─────────────────────────────────────────┘
```

**사용 기술**: PostgreSQL (관계형 데이터베이스)

---

## 🔄 주문이 실행되는 과정

### 1단계: 봇 시작

```
사용자가 "봇 시작" 버튼 클릭
                │
                ▼
┌─────────────────────────────────────────┐
│  1. 사용자의 API 키 확인                 │
│  2. 선택한 전략 로드                     │
│  3. Bitget 연결                         │
│  4. 실시간 데이터 수신 시작              │
└─────────────────────────────────────────┘
```

### 2단계: 시그널 생성 (사야 할지 팔아야 할지 판단)

```
┌─────────────────────────────────────────┐
│  📊 실시간 가격 데이터 수신              │
│  • 현재 BTC 가격: $90,000               │
│  • 1분 봉 캔들 200개 수집               │
└─────────────────────────────────────────┘
                │
                ▼
┌─────────────────────────────────────────┐
│  🔍 전략 분석                            │
│                                         │
│  if RSI < 30:                           │
│      → "과매도! 사야 할 때" (LONG)        │
│                                         │
│  if RSI > 70:                           │
│      → "과매수! 팔아야 할 때" (SHORT)     │
│                                         │
│  else:                                  │
│      → "기다림" (HOLD)                   │
└─────────────────────────────────────────┘
                │
                ▼
┌─────────────────────────────────────────┐
│  🟢 결과: "LONG" 시그널 발생!            │
└─────────────────────────────────────────┘
```

### 3단계: 주문 크기 계산 (얼마나 살지 결정)

```
┌─────────────────────────────────────────┐
│  💰 사용자 잔고 조회                     │
│  • 현재 잔고: $1,000 USDT               │
└─────────────────────────────────────────┘
                │
                ▼
┌─────────────────────────────────────────┐
│  ⚙️ 전략 설정 확인                       │
│  • position_size_percent: 40%           │
│  • leverage: 10x                        │
└─────────────────────────────────────────┘
                │
                ▼
┌─────────────────────────────────────────┐
│  🧮 계산                                 │
│                                         │
│  사용할 금액 = $1,000 × 40% = $400       │
│  레버리지 적용 = $400 × 10 = $4,000      │
│  BTC 수량 = $4,000 ÷ $90,000 = 0.044 BTC│
└─────────────────────────────────────────┘
```

### 4단계: Bitget에 주문 전송

```
┌─────────────────────────────────────────┐
│  📤 Bitget API 호출                      │
│                                         │
│  POST /api/v2/mix/order/place-order     │
│  {                                      │
│    "symbol": "BTCUSDT",                 │
│    "side": "buy",                       │
│    "size": "0.044",                     │
│    "leverage": "10",                    │
│    "orderType": "market"                │
│  }                                      │
└─────────────────────────────────────────┘
                │
                ▼
┌─────────────────────────────────────────┐
│  ✅ Bitget 응답: 주문 체결 완료!          │
│  • orderId: "123456789"                 │
│  • 체결 가격: $90,050                    │
└─────────────────────────────────────────┘
```

### 5단계: 알림 전송

```
┌─────────────────────────────────────────┐
│  📱 텔레그램 메시지 전송                  │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 🟢 새로운 거래 진입!               │  │
│  │                                   │  │
│  │ • 심볼: BTCUSDT                   │  │
│  │ • 방향: 🟢 LONG                   │  │
│  │ • 진입가: $90,050                 │  │
│  │ • 수량: 0.044 BTC                 │  │
│  │ • 레버리지: 10x                   │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

---

## 🤖 AI의 역할

### 현재 시스템에서 AI란?

> **중요**: 이 시스템에서 "AI"는 실제 인공지능이 아니라 **"미리 정해진 규칙에 따라 자동으로 판단하는 프로그램"**을 의미합니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                     🧠 "AI" = 자동화된 규칙                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  전략 1: RSI 역추세                                              │
│  ┌───────────────────────────────────────┐                      │
│  │ if RSI < 30:      → 매수 (저점 매수)   │                      │
│  │ if RSI > 70:      → 매도 (고점 매도)   │                      │
│  └───────────────────────────────────────┘                      │
│                                                                 │
│  전략 2: 볼린저밴드 스캘핑                                        │
│  ┌───────────────────────────────────────┐                      │
│  │ if 가격 < 하단밴드:  → 매수            │                      │
│  │ if 가격 > 상단밴드:  → 매도            │                      │
│  └───────────────────────────────────────┘                      │
│                                                                 │
│  전략 3: 이동평균 크로스                                          │
│  ┌───────────────────────────────────────┐                      │
│  │ if 단기선 > 장기선:  → 매수 (상승세)   │                      │
│  │ if 단기선 < 장기선:  → 매도 (하락세)   │                      │
│  └───────────────────────────────────────┘                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### AI가 하는 일 vs 하지 않는 일

| AI가 하는 일 ✅ | AI가 하지 않는 일 ❌ |
|----------------|---------------------|
| 정해진 규칙대로 판단 | 스스로 학습하기 |
| 자동으로 주문 실행 | 규칙 스스로 만들기 |
| 24시간 모니터링 | 시장 예측하기 |
| 빠른 반응속도 | 감정 가지기 |

---

## 📁 폴더 구조 설명

```
auto-dashboard/
│
├── 📂 backend/                    ← 🔧 백엔드 (Python)
│   ├── 📂 src/
│   │   ├── 📂 api/                ← API 엔드포인트 (URL 경로)
│   │   │   ├── auth.py            ← 로그인/회원가입
│   │   │   ├── bot.py             ← 봇 시작/중지
│   │   │   ├── strategy.py        ← 전략 관리
│   │   │   └── account.py         ← 계정 정보
│   │   │
│   │   ├── 📂 services/           ← 핵심 비즈니스 로직 ⭐
│   │   │   ├── bot_runner.py      ← 봇 실행 엔진 (가장 중요!)
│   │   │   ├── bitget_rest.py     ← Bitget API 통신
│   │   │   ├── strategy_loader.py ← 전략 로딩
│   │   │   └── telegram/          ← 텔레그램 알림
│   │   │
│   │   ├── 📂 strategies/         ← 트레이딩 전략들
│   │   │   ├── rsi_strategy.py    ← RSI 전략
│   │   │   ├── bollinger_strategy.py ← 볼린저 전략
│   │   │   └── instant_entry.py   ← 즉시 진입 (테스트용)
│   │   │
│   │   └── 📂 database/           ← 데이터베이스 연결
│   │       └── models.py          ← 테이블 정의
│   │
│   └── requirements.txt           ← Python 라이브러리 목록
│
├── 📂 frontend/                   ← 🖥️ 프론트엔드 (React)
│   ├── 📂 src/
│   │   ├── 📂 pages/              ← 페이지들
│   │   │   ├── Login.jsx          ← 로그인 페이지
│   │   │   ├── Trading.jsx        ← 트레이딩 대시보드
│   │   │   └── Settings.jsx       ← 설정 페이지
│   │   │
│   │   ├── 📂 components/         ← UI 컴포넌트들
│   │   │   ├── TradingChart.jsx   ← 차트 컴포넌트
│   │   │   └── PositionList.jsx   ← 포지션 목록
│   │   │
│   │   └── 📂 services/           ← API 통신
│   │       └── api.js             ← API 호출 함수들
│   │
│   └── package.json               ← JavaScript 라이브러리 목록
│
├── 📂 docs/                       ← 📚 문서들
│   └── archive/                   ← 아카이브된 문서들
│
├── 📂 scripts/                    ← 🛠️ 유틸리티 스크립트
│   └── deploy.sh                  ← 배포 스크립트
│
├── docker-compose.yml             ← 🐳 Docker 설정
├── README.md                      ← 프로젝트 설명
└── SECURITY_AND_CLEANUP.md        ← 보안 가이드
```

---

## 💻 실제 코드 흐름

### 1. 봇 시작 API 호출

**프론트엔드** → **백엔드**

```javascript
// frontend/src/pages/Trading.jsx
const startBot = async () => {
    await api.post('/bot/start', { strategy_id: 12 });
};
```

### 2. 백엔드에서 봇 실행

**파일**: `backend/src/api/bot.py`

```python
@router.post("/bot/start")
async def start_bot(request: BotStartRequest, user = current_user):
    # 1. 봇 러너 가져오기
    bot_runner = get_bot_runner()
    
    # 2. 봇 시작
    await bot_runner.start_user_bot(
        user_id=user.id,
        strategy_id=request.strategy_id
    )
    
    return {"is_running": True}
```

### 3. 봇 러너 - 핵심 엔진

**파일**: `backend/src/services/bot_runner.py`

```python
async def start_user_bot(self, user_id, strategy_id):
    # 1. 사용자 API 키 가져오기
    api_keys = await get_api_keys(user_id)
    
    # 2. Bitget 클라이언트 생성
    bitget_client = BitgetRestClient(
        api_key=api_keys.api_key,
        api_secret=api_keys.api_secret
    )
    
    # 3. 전략 로드
    strategy = await get_strategy(strategy_id)
    
    # 4. 실시간 데이터 수신 시작
    while is_running:
        # 가격 데이터 받기
        candles = await get_candles()
        
        # 전략 분석
        signal = strategy.generate_signal(candles)
        
        if signal == "LONG":
            # 잔고 조회
            balance = await bitget_client.fetch_balance()
            
            # 주문 크기 계산
            size = balance * position_percent * leverage / price
            
            # 주문 실행
            await bitget_client.place_order("buy", size)
            
            # 텔레그램 알림
            await telegram.notify("LONG 진입!")
```

### 4. 전략 코드 예시

**파일**: `backend/src/strategies/rsi_strategy.py`

```python
def check_entry_signal(candles, params):
    """
    RSI 기반 진입 시그널 확인
    
    RSI < 30: 과매도 → 매수
    RSI > 70: 과매수 → 매도
    """
    # RSI 계산
    rsi = calculate_rsi(candles, period=14)
    
    # 판단
    if rsi < 30:
        return "LONG"   # 살 때!
    elif rsi > 70:
        return "SHORT"  # 팔 때!
    else:
        return None     # 기다림
```

---

## 🎯 다중 사용자 지원

### 같은 전략, 다른 잔고

```
┌──────────────────────────────────────────────────────────────────┐
│                    📊 공통 전략: RSI 역추세                        │
│                    ⚙️ 설정: 잔고의 40% 사용, 10배 레버리지          │
├──────────────────────────────────────────────────────────────────┤
│                                                                  │
│  👤 사용자 A                     👤 사용자 B                       │
│  ├─ 잔고: $10,000               ├─ 잔고: $500                     │
│  ├─ 40% = $4,000                ├─ 40% = $200                     │
│  ├─ ×10배 = $40,000             ├─ ×10배 = $2,000                 │
│  └─ 주문: 0.44 BTC              └─ 주문: 0.022 BTC                │
│                                                                  │
│  👤 사용자 C                                                      │
│  ├─ 잔고: $100                                                   │
│  ├─ 40% = $40                                                    │
│  ├─ ×10배 = $400                                                 │
│  └─ 주문: 0.0044 BTC (최소 0.001로 조정)                          │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

**핵심**: 같은 전략이라도 각 사용자의 **실제 잔고에 맞춰** 주문 크기가 자동 계산됩니다!

---

## 🔐 보안 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                        🔐 보안 레이어                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1️⃣ 사용자 인증                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 로그인 → JWT 토큰 발급 → 매 요청마다 토큰 검증            │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  2️⃣ API 키 암호화                                               │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 사용자 API 키 → AES 암호화 → 데이터베이스 저장            │   │
│  │ (누군가 DB를 해킹해도 API 키를 볼 수 없음)               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  3️⃣ 환경변수 분리                                               │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 비밀번호, 암호키 → .env 파일 → Git에 올리지 않음          │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📊 현재 구현된 기능 체크리스트

### ✅ 완료된 기능

| 기능 | 상태 | 설명 |
|------|------|------|
| 사용자 로그인/회원가입 | ✅ | JWT 기반 인증 |
| API 키 등록 | ✅ | AES 암호화 저장 |
| 실시간 차트 | ✅ | WebSocket 연결 |
| 봇 시작/중지 | ✅ | 자동 매매 |
| 전략 선택 | ✅ | 다양한 전략 |
| 잔고 기반 주문 | ✅ | 비율 자동 계산 |
| 레버리지 설정 | ✅ | Bitget API |
| 텔레그램 알림 | ✅ | 거래 알림 |
| 포지션 조회 | ✅ | 실시간 |
| 자동 청산 | ✅ | 봇 중지 시 |

### 🔜 향후 추가 가능 기능

| 기능 | 설명 |
|------|------|
| 손절/익절 설정 | 자동 스톱로스, 테이크프로핏 |
| 백테스트 | 과거 데이터로 전략 테스트 |
| 성과 분석 | 수익률 차트, 통계 |
| 다중 거래소 | Binance, Bybit 등 |

---

## 🎓 용어 정리

| 용어 | 설명 |
|------|------|
| **LONG** | 가격이 오를 것으로 예상하고 매수 (사기) |
| **SHORT** | 가격이 내릴 것으로 예상하고 매도 (팔기) |
| **레버리지** | 빌린 돈으로 더 큰 금액 거래 (10배 = 10배 규모) |
| **포지션** | 현재 보유한 거래 상태 |
| **RSI** | 상대강도지수 - 과매수/과매도 판단 지표 |
| **볼린저밴드** | 가격 변동성 기반 상한/하한 밴드 |
| **캔들** | 시가/고가/저가/종가를 보여주는 봉 차트 |
| **API 키** | 거래소와 통신하기 위한 인증 키 |

---

## 🆘 문제 해결

### 봇이 안 돌아가요

1. **API 키 확인**: 설정에서 API 키가 제대로 등록됐는지 확인
2. **잔고 확인**: Bitget 계정에 USDT가 있는지 확인
3. **로그 확인**: `docker logs trading-backend --tail 100`

### 주문이 안 들어가요

1. **최소 주문량**: BTC 0.001개, ETH 0.01개 이상 필요
2. **잔고 부족**: 레버리지 적용해도 잔고가 부족할 수 있음
3. **API 권한**: Bitget에서 API 키에 거래 권한 부여 확인

### 텔레그램 알림이 안 와요

1. **봇 시작**: 텔레그램에서 봇에게 `/start` 메시지 보내기
2. **Chat ID**: 올바른 Chat ID 설정 확인
3. **Token**: 봇 토큰이 정확한지 확인

---

**이 문서는 Auto-Dashboard 트레이딩 봇 시스템의 완전한 가이드입니다.**  
**궁금한 점이 있으면 언제든 질문해주세요! 🚀**
