# 🤖 다중 봇 시스템 구현 계획서 (1/3)

# 📋 프로젝트 개요 및 작업 체크리스트

---

## 📌 문서 정보

| 항목 | 내용 |
|------|------|
| 작성일 | 2025-12-10 |
| 버전 | 1.0 |
| 프로젝트 | auto-dashboard |
| 관련 문서 | `02_DATABASE_DESIGN.md`, `03_IMPLEMENTATION_DETAIL.md` |

---

## 🎯 프로젝트 목표

### 현재 시스템 구조

```
┌─────────────────────────────────────────┐
│              사용자 A                    │
│  ┌─────────────────────────────────┐    │
│  │         1개 봇 실행              │    │
│  │    전략: 보수적 EMA              │    │
│  │    잔고: 전체 (100%)            │    │
│  └─────────────────────────────────┘    │
└─────────────────────────────────────────┘
```

### 목표 시스템 구조

```
┌─────────────────────────────────────────────────────────────┐
│                        사용자 A                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────┐   │
│  │  AI 봇 #1    │  │  AI 봇 #2    │  │   그리드 봇 #1    │   │
│  │  보수적 전략  │  │  공격적 전략  │  │   BTC 레인지     │   │
│  │  잔고: 30%   │  │  잔고: 20%   │  │   잔고: 50%      │   │
│  │  BTC 전용    │  │  ETH 전용    │  │   $90k~$100k    │   │
│  └──────────────┘  └──────────────┘  └──────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

---

## 👥 다중 사용자 고려사항

### 동시 사용 시나리오

- **예상 동시 사용자**: 100~1000명
- **사용자당 평균 봇 수**: 3개
- **총 동시 봇 수**: 300~3000개

### 리소스 관리

| 항목 | 제한 | 이유 |
|------|------|------|
| 사용자당 최대 봇 수 | 10개 | 서버 리소스 |
| 총 잔고 할당 | 100% | 잔고 충돌 방지 |
| 봇당 최대 레버리지 | 20x | 리스크 관리 |
| 그리드 봇 최대 그리드 수 | 100개 | API Rate Limit |

---

## ✅ 작업 체크리스트

### Phase 1: 데이터베이스 설계 (담당자: _______)

| 순번 | 작업 | 상태 | 담당자 | 시작일 | 완료일 |
|------|------|------|--------|--------|--------|
| 1.1 | [ ] `bot_instances` 테이블 스키마 설계 | 대기 | | | |
| 1.2 | [ ] `grid_bot_configs` 테이블 스키마 설계 | 대기 | | | |
| 1.3 | [ ] `grid_orders` 테이블 스키마 설계 | 대기 | | | |
| 1.4 | [ ] SQLAlchemy 모델 작성 | 대기 | | | |
| 1.5 | [ ] Alembic 마이그레이션 파일 생성 | 대기 | | | |
| 1.6 | [ ] 개발 DB에 마이그레이션 실행 | 대기 | | | |
| 1.7 | [ ] 테스트 데이터 시딩 스크립트 작성 | 대기 | | | |

### Phase 2: 백엔드 API (담당자: _______)

| 순번 | 작업 | 상태 | 담당자 | 시작일 | 완료일 |
|------|------|------|--------|--------|--------|
| 2.1 | [ ] `api/bot_instances.py` 파일 생성 | 대기 | | | |
| 2.2 | [ ] 봇 CRUD API 구현 | 대기 | | | |
| 2.3 | [ ] 봇 시작/중지 API 구현 | 대기 | | | |
| 2.4 | [ ] 잔고 할당 검증 로직 | 대기 | | | |
| 2.5 | [ ] `api/grid_bot.py` 파일 생성 | 대기 | | | |
| 2.6 | [ ] 그리드 봇 설정 API 구현 | 대기 | | | |
| 2.7 | [ ] API 스키마 (Pydantic) 작성 | 대기 | | | |

### Phase 3: 봇 런타임 (담당자: _______)

| 순번 | 작업 | 상태 | 담당자 | 시작일 | 완료일 |
|------|------|------|--------|--------|--------|
| 3.1 | [ ] `BotRunner` 리팩토링 (다중 봇 지원) | 대기 | | | |
| 3.2 | [ ] `AllocationManager` 클래스 구현 | 대기 | | | |
| 3.3 | [ ] `GridBotRunner` 클래스 구현 | 대기 | | | |
| 3.4 | [ ] 봇 인스턴스별 격리 로직 | 대기 | | | |
| 3.5 | [ ] 에러 핸들링 및 복구 로직 | 대기 | | | |
| 3.6 | [ ] 텔레그램 알림 연동 (봇별) | 대기 | | | |

### Phase 4: 프론트엔드 (담당자: _______)

| 순번 | 작업 | 상태 | 담당자 | 시작일 | 완료일 |
|------|------|------|--------|--------|--------|
| 4.1 | [ ] 봇 목록 페이지 UI | 대기 | | | |
| 4.2 | [ ] 봇 생성 모달 | 대기 | | | |
| 4.3 | [ ] 잔고 할당 시각화 바 | 대기 | | | |
| 4.4 | [ ] 그리드 봇 설정 UI | 대기 | | | |
| 4.5 | [ ] 그리드 시각화 차트 | 대기 | | | |
| 4.6 | [ ] 봇별 통계 대시보드 | 대기 | | | |
| 4.7 | [ ] API 연동 (`src/api/botInstances.js`) | 대기 | | | |

### Phase 5: 테스트 및 배포 (담당자: _______)

| 순번 | 작업 | 상태 | 담당자 | 시작일 | 완료일 |
|------|------|------|--------|--------|--------|
| 5.1 | [ ] 단위 테스트 작성 | 대기 | | | |
| 5.2 | [ ] 통합 테스트 작성 | 대기 | | | |
| 5.3 | [ ] 부하 테스트 (다중 사용자) | 대기 | | | |
| 5.4 | [ ] 스테이징 환경 배포 | 대기 | | | |
| 5.5 | [ ] QA 테스트 | 대기 | | | |
| 5.6 | [ ] 프로덕션 배포 | 대기 | | | |

---

## 📁 파일 구조 변경 계획

```
backend/src/
├── api/
│   ├── bot_instances.py      # [NEW] 다중 봇 API
│   └── grid_bot.py           # [NEW] 그리드 봇 API
├── services/
│   ├── bot_runner.py         # [MODIFY] 다중 봇 지원
│   ├── grid_bot_runner.py    # [NEW] 그리드 봇 로직
│   └── allocation_manager.py # [NEW] 잔고 할당 관리
├── schemas/
│   ├── bot_instance_schema.py    # [NEW]
│   └── grid_bot_schema.py        # [NEW]
└── database/
    └── models.py             # [MODIFY] 새 테이블 추가

frontend/src/
├── pages/
│   ├── BotManagement.jsx     # [NEW] 봇 관리 페이지
│   └── GridBotSetup.jsx      # [NEW] 그리드 봇 설정
├── components/
│   └── bots/
│       ├── BotList.jsx       # [NEW]
│       ├── BotCard.jsx       # [NEW]
│       ├── AllocationBar.jsx # [NEW]
│       └── GridVisualizer.jsx # [NEW]
└── api/
    ├── botInstances.js       # [NEW]
    └── gridBot.js            # [NEW]
```

---

## 🔄 작업 의존성 다이어그램

```
[1.1~1.7 DB 설계] ────┐
                      ├──▶ [2.1~2.7 API 구현]
[3.1~3.6 런타임] ◀────┘          │
       ▲                        │
       │                        ▼
       └────────────────[4.1~4.7 프론트엔드]
                               │
                               ▼
                        [5.1~5.6 테스트/배포]
```

---

## 📅 일정 요약

| 주차 | 주요 작업 | 병렬 가능 작업 |
|------|----------|---------------|
| 1주차 | DB 설계 (1.1~1.7) | - |
| 2주차 | API 구현 (2.1~2.7) | 런타임 설계 시작 |
| 3주차 | 런타임 구현 (3.1~3.6) | 프론트 UI 작업 |
| 4주차 | 프론트엔드 (4.1~4.7) | 테스트 작성 |
| 5주차 | 테스트/배포 (5.1~5.6) | 문서화 |

---

**다음 문서**: `02_DATABASE_DESIGN.md` (테이블 상세 설계)
