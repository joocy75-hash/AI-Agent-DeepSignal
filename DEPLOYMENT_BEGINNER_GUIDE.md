# 🚀 배포 과정 완전 초보 가이드

> **작성일**: 2025-12-09  
> **대상**: Git, Docker가 처음인 분들을 위한 설명서

---

## 📚 목차

1. [전체 그림 먼저 이해하기](#-전체-그림-먼저-이해하기)
2. [Git이란?](#-git이란)
3. [Docker란?](#-docker란)
4. [배포 과정 전체 흐름](#-배포-과정-전체-흐름)
5. [실제 명령어 설명](#-실제-명령어-설명)

---

## 🎯 전체 그림 먼저 이해하기

### 쉽게 비유하면

```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│   🏠 내 컴퓨터 (로컬)          ☁️ 인터넷              🏢 서버 (클라우드)   │
│   ┌─────────────┐              │               ┌─────────────┐          │
│   │             │              │               │             │          │
│   │  개발 작업   │ ──────────────────────────▶ │  실제 서비스  │          │
│   │  (코드 수정) │              │               │  (24시간)    │          │
│   │             │              │               │             │          │
│   └─────────────┘              │               └─────────────┘          │
│                                │                                        │
│   비유: 주방에서               │               비유: 음식점              │
│   요리 레시피 개발                               손님에게 서빙           │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 핵심 도구들

| 도구 | 비유 | 역할 |
|------|------|------|
| **Git** | 📝 작업 노트 | 코드 변경 기록 저장 |
| **GitHub** | 📚 공유 도서관 | 코드를 인터넷에 저장 |
| **Docker** | 📦 이사 박스 | 프로그램을 깔끔하게 포장 |
| **서버** | 🏢 임대 사무실 | 24시간 돌아가는 컴퓨터 |

---

## 📝 Git이란?

### 한 마디로

> **코드의 "저장 버튼"을 더 똑똑하게 만든 것**

### 워드 문서와 비교

```
❌ 워드 문서 저장 방식 (안 좋은 방법)
┌────────────────────────────────────────┐
│  📄 프로젝트_최종.doc                    │
│  📄 프로젝트_최종_진짜최종.doc            │
│  📄 프로젝트_최종_진짜최종_수정.doc        │
│  📄 프로젝트_최종_진짜최종_수정_확정.doc   │
│  📄 프로젝트_최종_진짜최종_수정_확정2.doc  │
└────────────────────────────────────────┘

✅ Git 방식 (좋은 방법)
┌────────────────────────────────────────┐
│  📄 프로젝트.doc                         │
│                                         │
│  └─ 버전 기록:                           │
│      • 12/09 18:00 - 로그인 기능 추가     │
│      • 12/09 15:00 - 버그 수정           │
│      • 12/08 20:00 - 첫 번째 버전        │
│                                         │
│  → 언제든지 과거 버전으로 돌아갈 수 있음!   │
└────────────────────────────────────────┘
```

### Git 핵심 용어

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           Git 용어 사전                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  📂 Repository (레포지토리, 레포)                                        │
│  ├─ = "프로젝트 폴더"                                                    │
│  └─ 모든 코드와 변경 기록이 저장되는 곳                                    │
│                                                                         │
│  💾 Commit (커밋)                                                        │
│  ├─ = "저장 + 메모 남기기"                                               │
│  └─ "이 시점의 코드 상태를 기억해둬"                                       │
│                                                                         │
│  📤 Push (푸시)                                                          │
│  ├─ = "내 컴퓨터 → GitHub로 업로드"                                       │
│  └─ 인터넷에 백업하는 느낌                                                │
│                                                                         │
│  📥 Pull (풀)                                                            │
│  ├─ = "GitHub → 내 컴퓨터로 다운로드"                                     │
│  └─ 최신 버전 가져오기                                                   │
│                                                                         │
│  🌿 Branch (브랜치)                                                      │
│  ├─ = "평행 세계"                                                       │
│  └─ 원본 망가뜨리지 않고 새 기능 개발                                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### Git 작업 흐름

```
┌──────────────────────────────────────────────────────────────────┐
│                        Git 작업 흐름                              │
├──────────────────────────────────────────────────────────────────┤
│                                                                  │
│   1️⃣ 코드 수정                                                   │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  파일을 수정하고 저장                                      │   │
│   │  📝 bot_runner.py 수정함                                  │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           │                                      │
│                           ▼                                      │
│   2️⃣ 변경사항 확인 (git status)                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  "어떤 파일이 바뀌었는지 확인"                              │   │
│   │  → M bot_runner.py (수정됨)                               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           │                                      │
│                           ▼                                      │
│   3️⃣ 변경사항 스테이징 (git add)                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  "이 파일들을 저장할 준비"                                  │   │
│   │  → 커밋할 파일들을 선택                                    │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           │                                      │
│                           ▼                                      │
│   4️⃣ 커밋 (git commit)                                          │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  "저장 + 메모 남기기"                                       │   │
│   │  → git commit -m "버그 수정함"                             │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           │                                      │
│                           ▼                                      │
│   5️⃣ 푸시 (git push)                                            │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  "GitHub에 업로드"                                         │   │
│   │  → 인터넷에 안전하게 백업됨!                                │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

---

## 📦 Docker란?

### 한 마디로

> **컴퓨터 안에 미니 컴퓨터를 만드는 기술**

### 왜 필요한가요?

```
❌ Docker 없이 배포하면...

개발자: "내 컴퓨터에서는 잘 돌아가는데?"
서버:   "여기선 에러나요"

원인:
• 파이썬 버전이 다름 (3.9 vs 3.11)
• 필요한 라이브러리가 없음
• 설정 파일이 다름



✅ Docker로 배포하면...

개발자: "이 박스(컨테이너) 통째로 가져가세요"
서버:   "네, 완벽하게 똑같이 실행됩니다!"

Docker는 '환경'까지 함께 포장!
```

### Docker 핵심 용어

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         Docker 용어 사전                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  📋 Dockerfile                                                          │
│  ├─ = "설치 설명서"                                                     │
│  └─ "이 프로그램을 실행하려면 이것들이 필요해요" 라고 적어둔 문서          │
│                                                                         │
│  📀 Image (이미지)                                                       │
│  ├─ = "설치 CD"                                                         │
│  └─ Dockerfile을 바탕으로 만든 설치 파일                                  │
│                                                                         │
│  📦 Container (컨테이너)                                                 │
│  ├─ = "실행 중인 프로그램"                                               │
│  └─ Image를 실제로 실행한 상태                                           │
│                                                                         │
│  🎼 docker-compose                                                      │
│  ├─ = "오케스트라 지휘자"                                                │
│  └─ 여러 컨테이너를 한 번에 관리                                         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 이미지 vs 컨테이너

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      Image vs Container 비유                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   📀 Image (이미지)                   📦 Container (컨테이너)            │
│   ┌─────────────────────┐            ┌─────────────────────┐            │
│   │                     │            │                     │            │
│   │   게임 설치 CD       │     →      │   실행 중인 게임     │            │
│   │                     │            │                     │            │
│   └─────────────────────┘            └─────────────────────┘            │
│                                                                         │
│   • 변하지 않음 (읽기 전용)            • 실제로 동작 중                    │
│   • 여러 개 복사 가능                 • 멈추면 종료됨                     │
│   • 저장 공간만 차지                  • CPU, 메모리 사용                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 우리 프로젝트의 컨테이너들

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Auto-Dashboard Docker 구성                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   docker-compose.yml 파일에 정의된 4개의 컨테이너:                         │
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐  │
│   │  📦 trading-backend                                              │  │
│   │  ├─ 역할: Python 백엔드 서버                                      │  │
│   │  ├─ 포트: 8000                                                   │  │
│   │  └─ 하는 일: API 처리, 봇 실행, 주문 실행                          │  │
│   └─────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐  │
│   │  📦 trading-frontend                                             │  │
│   │  ├─ 역할: React 프론트엔드 서버                                   │  │
│   │  ├─ 포트: 3000                                                   │  │
│   │  └─ 하는 일: 사용자 화면 제공                                     │  │
│   └─────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐  │
│   │  📦 trading-postgres                                             │  │
│   │  ├─ 역할: 데이터베이스 서버                                       │  │
│   │  ├─ 포트: 5432                                                   │  │
│   │  └─ 하는 일: 사용자 정보, 거래 기록 저장                           │  │
│   └─────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐  │
│   │  📦 trading-redis                                                │  │
│   │  ├─ 역할: 캐시 서버                                               │  │
│   │  ├─ 포트: 6379                                                   │  │
│   │  └─ 하는 일: 임시 데이터 빠르게 저장                               │  │
│   └─────────────────────────────────────────────────────────────────┘  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 배포 과정 전체 흐름

### 전체 과정을 요리로 비유

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     배포 = 음식점 오픈 과정                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  1️⃣ 레시피 개발 (코드 작성)                                             │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  주방(내 컴퓨터)에서 새 레시피(코드) 개발                            │ │
│  │  "이 기능 추가해야겠다"                                             │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                              │                                          │
│                              ▼                                          │
│  2️⃣ 레시피 저장 (Git Commit)                                           │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  레시피북에 새 레시피 기록                                          │ │
│  │  git commit -m "새 메뉴 추가"                                       │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                              │                                          │
│                              ▼                                          │
│  3️⃣ 본사에 레시피 전달 (Git Push / rsync)                              │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  본사(서버)에 새 레시피 전달                                        │ │
│  │  rsync로 파일 업로드                                               │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                              │                                          │
│                              ▼                                          │
│  4️⃣ 조리도구 업데이트 (Docker Build)                                   │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  새 레시피에 맞게 주방 기구 재설정                                   │ │
│  │  docker compose build                                              │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                              │                                          │
│                              ▼                                          │
│  5️⃣ 음식점 재오픈 (Docker Up)                                          │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  새 레시피로 음식점 운영 시작!                                       │ │
│  │  docker compose up -d                                              │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 실제 배포 흐름도

```
┌────────────────┐      ┌────────────────┐      ┌────────────────┐
│  🏠 내 컴퓨터   │      │   ☁️ GitHub    │      │   🏢 서버      │
│   (맥북/PC)    │      │   (선택사항)    │      │   (Vultr)      │
└───────┬────────┘      └───────┬────────┘      └───────┬────────┘
        │                       │                       │
        │  1. 코드 수정          │                       │
        │  ──────────▶         │                       │
        │                       │                       │
        │  2. git commit        │                       │
        │  ──────────▶         │                       │
        │                       │                       │
        │  3. rsync로 업로드    ─────────────────────────▶
        │                       │                       │
        │                       │       4. docker build │
        │                       │       ◀───────────────│
        │                       │                       │
        │                       │       5. docker up    │
        │                       │       ◀───────────────│
        │                       │                       │
        │                       │       ✅ 배포 완료!    │
        ▼                       ▼                       ▼
```

---

## 💻 실제 명령어 설명

### Git 명령어

```bash
# 📊 현재 상태 확인 "뭐가 바뀌었나?"
git status

# 📋 출력 예시:
# M  backend/src/services/bot_runner.py  ← 수정된 파일
# ?? new_file.py                         ← 새로 추가된 파일
```

```bash
# ➕ 변경사항 스테이징 (저장 준비)
git add .                    # 모든 파일
git add bot_runner.py        # 특정 파일만
```

```bash
# 💾 커밋 (저장 + 메모)
git commit -m "로그인 버그 수정"

# 메모를 잘 쓰면 나중에 찾기 쉬움!
# ❌ "수정함" 
# ✅ "로그인 시 비밀번호 오류 메시지 개선"
```

```bash
# 📤 푸시 (GitHub에 업로드)
git push origin main
```

### Docker 명령어

```bash
# 📋 현재 실행 중인 컨테이너 보기
docker ps

# 출력 예시:
# NAMES              STATUS         PORTS
# trading-backend    Up 2 hours     8000
# trading-frontend   Up 2 hours     3000
# trading-postgres   Up 2 hours     5432
# trading-redis      Up 2 hours     6379
```

```bash
# 🔨 이미지 다시 빌드 (코드 변경 후)
docker compose build

# 또는 특정 서비스만
docker compose build backend
```

```bash
# 🚀 컨테이너 시작
docker compose up -d

# -d = detached (백그라운드에서 실행)
# 이거 없으면 터미널 닫으면 서버도 꺼짐!
```

```bash
# 🛑 컨테이너 중지
docker compose down
```

```bash
# 📜 로그 보기 (에러 확인)
docker logs trading-backend --tail 100

# --tail 100 = 마지막 100줄만
```

```bash
# 🔄 컨테이너 재시작
docker compose restart backend
```

### 배포 통합 명령어 (우리가 자주 쓰는 것)

```bash
# 🚀 전체 배포 과정 (한 번에)

# 1. 로컬에서 서버로 파일 복사
sshpass -p 'YOUR_PASSWORD' rsync -avz \
  /Users/mr.joo/Desktop/auto-dashboard/backend/src/ \
  root@158.247.245.197:/root/auto-dashboard/backend/src/

# 2. 서버에서 도커 빌드 및 시작
ssh root@158.247.245.197 "cd /root/auto-dashboard && \
  docker compose build backend && \
  docker compose up -d backend"
```

---

## 🗺️ 서버 접속 방법

### SSH란?

> **멀리 있는 컴퓨터를 원격으로 조종하는 기술**

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           SSH 접속                                       │
│                                                                         │
│   🏠 내 컴퓨터                           🏢 서버                         │
│   ┌─────────────┐     SSH 터널          ┌─────────────┐                │
│   │             │ ═══════════════════▶  │             │                │
│   │   터미널     │                       │   터미널     │                │
│   │   (로컬)    │ ◀═══════════════════  │   (원격)    │                │
│   └─────────────┘                       └─────────────┘                │
│                                                                         │
│   마치 서버 컴퓨터 앞에 앉아있는 것처럼 명령어 실행 가능!                   │
└─────────────────────────────────────────────────────────────────────────┘
```

```bash
# 서버 접속
ssh root@158.247.245.197

# 비밀번호 입력 후 접속됨
# 이제 서버에서 직접 명령어 실행 가능!
```

---

## 📝 자주 쓰는 명령어 모음

### 일상적인 배포

```bash
# 백엔드만 업데이트
rsync -avz backend/src/ root@서버IP:/root/auto-dashboard/backend/src/
ssh root@서버IP "cd /root/auto-dashboard && docker compose build backend && docker compose up -d backend"

# 프론트엔드만 업데이트  
rsync -avz frontend/src/ root@서버IP:/root/auto-dashboard/frontend/src/
ssh root@서버IP "cd /root/auto-dashboard && docker compose build frontend && docker compose up -d frontend"
```

### 문제 해결용

```bash
# 서버 상태 확인
ssh root@서버IP "docker ps"

# 에러 로그 보기
ssh root@서버IP "docker logs trading-backend --tail 100"

# 컨테이너 재시작
ssh root@서버IP "docker compose restart backend"

# 모든 것 다시 시작
ssh root@서버IP "docker compose down && docker compose up -d"
```

---

## ❓ 자주 묻는 질문

### Q: 왜 서버가 필요해요?

> 내 컴퓨터는 자고 있을 때 꺼지지만, 서버는 24시간 돌아갑니다!
> 트레이딩 봇은 24시간 시장을 감시해야 하니까요.

### Q: Docker 없이 배포하면 안 되나요?

> 됩니다! 하지만...
>
> - Python 버전 맞추기
> - 라이브러리 하나씩 설치
> - 설정 파일 수동 작성
> - 에러나면 원인 찾기 어려움
>
> Docker는 이 모든 걸 자동화해줍니다.

### Q: Git 없이 배포하면 안 되나요?

> 됩니다! 하지만...
>
> - 어떤 파일을 수정했는지 잊어버림
> - 잘못 수정했을 때 되돌리기 어려움
> - 팀 작업 시 충돌 발생
>
> Git은 "타임머신"과 같습니다.

### Q: rsync가 뭐예요?

> `rsync` = **원격 동기화** 도구
>
> 내 컴퓨터 파일을 서버로 복사하는 명령어입니다.
> 변경된 파일만 업로드해서 빠릅니다.

---

## 🎓 용어 정리

| 용어 | 쉬운 설명 |
|------|----------|
| **로컬(Local)** | 내 컴퓨터 |
| **원격(Remote)** | 서버/다른 컴퓨터 |
| **배포(Deploy)** | 서버에 프로그램 올리기 |
| **빌드(Build)** | 코드를 실행 가능하게 만들기 |
| **SSH** | 원격 컴퓨터 접속 방법 |
| **터미널** | 명령어 입력하는 검은 화면 |
| **레포(Repository)** | 프로젝트 폴더 |
| **커밋(Commit)** | 저장 + 메모 |
| **푸시(Push)** | 업로드 |
| **풀(Pull)** | 다운로드 |
| **이미지(Image)** | 실행 파일 (설치 CD) |
| **컨테이너(Container)** | 실행 중인 프로그램 |

---

## 🚀 빠른 참조 카드

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        ⚡ 빠른 명령어 참조                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  📝 Git                                                                 │
│  ├─ git status          → 변경사항 확인                                 │
│  ├─ git add .           → 모든 파일 스테이징                            │
│  ├─ git commit -m "메모" → 커밋                                         │
│  └─ git push            → GitHub에 업로드                               │
│                                                                         │
│  🐳 Docker                                                              │
│  ├─ docker ps           → 실행 중인 컨테이너                            │
│  ├─ docker logs [이름]   → 로그 보기                                    │
│  ├─ docker compose build → 이미지 빌드                                  │
│  ├─ docker compose up -d → 컨테이너 시작                                │
│  └─ docker compose down  → 컨테이너 중지                                │
│                                                                         │
│  🖥️ 서버                                                                │
│  ├─ ssh root@서버IP      → 서버 접속                                    │
│  └─ rsync -avz 로컬 원격  → 파일 복사                                    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

**이 문서가 도움이 되셨으면 좋겠습니다! 궁금한 점 있으면 언제든 물어보세요! 🙌**
